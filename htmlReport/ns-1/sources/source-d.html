<!DOCTYPE html>
<html id="htmlId">
<head>
    <title>Coverage Report > MonthViewFragment</title>
    <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";


    </style>
    <script src="../../js/highlight.min.js" type="text/javascript"></script>
    <script src="../../js/highlightjs-line-numbers.min.js" type="text/javascript"></script>
</head>

<body>
<div class="content">
    <div class="breadCrumbs">
        Current scope: <a href="../../index.html">all classes</a>
        <span class="separator">|</span>
        <a href="../index.html">com.example.sharedcalendar</a>
    </div>

    <h1>Coverage Summary for Class: MonthViewFragment (com.example.sharedcalendar)</h1>

    <table class="coverageStats">

        <tr>
            <th class="name">Class</th>
            <th class="coverageStat
">
                Method, %
            </th>
            <th class="coverageStat
">
                Line, %
            </th>
        </tr>
        <tr>
            <td class="name">MonthViewFragment</td>
            <td class="coverageStat">
  <span class="percent">
    77.8%
  </span>
                <span class="absValue">
    (7/9)
  </span>
            </td>
            <td class="coverageStat">
  <span class="percent">
    77.8%
  </span>
                <span class="absValue">
    (28/36)
  </span>
            </td>
        </tr>
        <tr>
            <td class="name">MonthViewFragment$Companion</td>
            <td class="coverageStat">
  <span class="percent">
    100%
  </span>
                <span class="absValue">
    (1/1)
  </span>
            </td>
            <td class="coverageStat">
  <span class="percent">
    100%
  </span>
                <span class="absValue">
    (1/1)
  </span>
            </td>
        </tr>
        <tr>
            <td class="name">MonthViewFragment$configureBinders$1</td>
            <td class="coverageStat">
  <span class="percent">
    33.3%
  </span>
                <span class="absValue">
    (1/3)
  </span>
            </td>
            <td class="coverageStat">
  <span class="percent">
    4.3%
  </span>
                <span class="absValue">
    (1/23)
  </span>
            </td>
        </tr>
        <tr>
            <td class="name">MonthViewFragment$configureBinders$2</td>
            <td class="coverageStat">
  <span class="percent">
    33.3%
  </span>
                <span class="absValue">
    (1/3)
  </span>
            </td>
            <td class="coverageStat">
  <span class="percent">
    8.3%
  </span>
                <span class="absValue">
    (1/12)
  </span>
            </td>
        </tr>
        <tr>
            <td class="name">MonthViewFragment$configureBinders$2$bind$1</td>
            <td class="coverageStat">
  <span class="percent">
    0%
  </span>
                <span class="absValue">
    (0/1)
  </span>
            </td>
            <td class="coverageStat">
  <span class="percent">
    0%
  </span>
                <span class="absValue">
    (0/1)
  </span>
            </td>
        </tr>
        <tr>
            <td class="name">MonthViewFragment$configureBinders$DayViewContainer</td>
            <td class="coverageStat">
  <span class="percent">
    0%
  </span>
                <span class="absValue">
    (0/3)
  </span>
            </td>
            <td class="coverageStat">
  <span class="percent">
    0%
  </span>
                <span class="absValue">
    (0/12)
  </span>
            </td>
        </tr>
        <tr>
            <td class="name">MonthViewFragment$configureBinders$MonthViewContainer</td>
            <td class="coverageStat">
  <span class="percent">
    0%
  </span>
                <span class="absValue">
    (0/1)
  </span>
            </td>
            <td class="coverageStat">
  <span class="percent">
    0%
  </span>
                <span class="absValue">
    (0/2)
  </span>
            </td>
        </tr>
        <tr>
            <td class="name">MonthViewFragment$onViewCreated$1</td>
            <td class="coverageStat">
  <span class="percent">
    0%
  </span>
                <span class="absValue">
    (0/1)
  </span>
            </td>
            <td class="coverageStat">
  <span class="percent">
    0%
  </span>
                <span class="absValue">
    (0/5)
  </span>
            </td>
        </tr>
        <tr>
            <td class="name">MonthViewFragment$onViewCreated$2</td>
            <td class="coverageStat">
  <span class="percent">
    0%
  </span>
                <span class="absValue">
    (0/1)
  </span>
            </td>
            <td class="coverageStat">
  <span class="percent">
    0%
  </span>
                <span class="absValue">
    (0/6)
  </span>
            </td>
        </tr>
        <tr>
            <td class="name">MonthViewFragment$sam$androidx_lifecycle_Observer$0</td>
        </tr>
        <tr>
            <td class="name"><strong>Total</strong></td>
            <td class="coverageStat">
  <span class="percent">
    43.5%
  </span>
                <span class="absValue">
    (10/23)
  </span>
            </td>
            <td class="coverageStat">
  <span class="percent">
    31.6%
  </span>
                <span class="absValue">
    (31/98)
  </span>
            </td>
        </tr>
    </table>

    <br/>
    <br/>


    <pre>
<code class="sourceCode" id="sourceCode">&nbsp;package com.example.sharedcalendar
&nbsp;
&nbsp;import android.graphics.Color
&nbsp;import android.graphics.Typeface
&nbsp;import android.os.Bundle
&nbsp;import android.util.Log
&nbsp;import android.util.TypedValue
&nbsp;import android.view.View
&nbsp;import android.widget.TextView
&nbsp;import androidx.core.view.children
&nbsp;import androidx.fragment.app.Fragment
&nbsp;import androidx.lifecycle.ViewModelProvider
&nbsp;import com.example.sharedcalendar.databinding.CalendarDayBinding
&nbsp;import com.example.sharedcalendar.databinding.CalendarHeaderBinding
&nbsp;import com.example.sharedcalendar.databinding.FragmentMonthViewBinding
&nbsp;import com.example.sharedcalendar.models.Event
&nbsp;import com.example.sharedcalendar.models.displayText
&nbsp;import com.example.sharedcalendar.ui.editEvent.CalendarViewModel
&nbsp;import com.google.common.annotations.VisibleForTesting
&nbsp;import com.kizitonwose.calendar.core.CalendarDay
&nbsp;import com.kizitonwose.calendar.core.CalendarMonth
&nbsp;import com.kizitonwose.calendar.core.DayPosition
&nbsp;import com.kizitonwose.calendar.core.daysOfWeek
&nbsp;import com.kizitonwose.calendar.core.nextMonth
&nbsp;import com.kizitonwose.calendar.core.previousMonth
&nbsp;import com.kizitonwose.calendar.view.MonthDayBinder
&nbsp;import com.kizitonwose.calendar.view.MonthHeaderFooterBinder
&nbsp;import com.kizitonwose.calendar.view.ViewContainer
&nbsp;import java.time.DayOfWeek
&nbsp;import java.time.LocalDate
&nbsp;import java.time.YearMonth
&nbsp;
&nbsp;
<b class="fc">&nbsp;class MonthViewFragment : Fragment(R.layout.fragment_month_view) {</b>
&nbsp;
&nbsp;    @VisibleForTesting
<b class="fc">&nbsp;    lateinit var firebaseViewModel: FirebaseViewModel</b>
<b class="fc">&nbsp;    lateinit var calendarViewModel: CalendarViewModel</b>
&nbsp;    private var selectedDate: LocalDate? = null
&nbsp;
&nbsp;
&nbsp;    //            private val thisEvents = viewModel.getEvents(true).groupBy { it.startTime.toLocalDate() }
&nbsp;    private var eventsThisMonth: Map&lt;LocalDate, List&lt;Event&gt;&gt;? = null
<b class="fc">&nbsp;    lateinit var binding: FragmentMonthViewBinding</b>
&nbsp;
&nbsp;
&nbsp;    //    @RequiresApi(Build.VERSION_CODES.UPSIDE_DOWN_CAKE)
&nbsp;    override fun onViewCreated(view: View, savedInstanceState: Bundle?) {
<b class="fc">&nbsp;        super.onViewCreated(view, savedInstanceState)</b>
<b class="fc">&nbsp;        firebaseViewModel = ViewModelProvider(requireActivity())[FirebaseViewModel::class.java]</b>
&nbsp;
<b class="fc">&nbsp;        eventsThisMonth = firebaseViewModel.getGroupedEvents()</b>
&nbsp;
<b class="fc">&nbsp;        binding = FragmentMonthViewBinding.bind(view)</b>
<b class="fc">&nbsp;        calendarViewModel =</b>
<b class="fc">&nbsp;            ViewModelProvider(requireParentFragment())[CalendarViewModel::class.java]</b>
<b class="fc">&nbsp;        val daysOfWeek = daysOfWeek()</b>
<b class="fc">&nbsp;        val currentMonth = YearMonth.now()</b>
<b class="fc">&nbsp;        val startMonth = currentMonth.minusMonths(200)</b>
<b class="fc">&nbsp;        val endMonth = currentMonth.plusMonths(200)</b>
&nbsp;
&nbsp;        // Listen for Event Updates
<b class="fc">&nbsp;        firebaseViewModel.events.observe(viewLifecycleOwner) { events -&gt;</b>
<b class="nc">&nbsp;            Log.i(TAG, events.toString())</b>
&nbsp;            // Update Event list upon updates
<b class="nc">&nbsp;            eventsThisMonth = firebaseViewModel.getGroupedEvents()</b>
<b class="nc">&nbsp;            Log.i(TAG, &quot;Month View calendar Events updated&quot;)</b>
<b class="nc">&nbsp;            binding.MonthViewCalendar.notifyCalendarChanged()</b>
<b class="nc">&nbsp;        }</b>
&nbsp;
<b class="fc">&nbsp;        configureBinders(daysOfWeek)</b>
&nbsp;
&nbsp;        // Setup Month View
<b class="fc">&nbsp;        binding.MonthViewCalendar.setup(startMonth, endMonth, daysOfWeek.first())</b>
&nbsp;        // Scroll month view to current month
<b class="fc">&nbsp;        binding.MonthViewCalendar.scrollToMonth(currentMonth)</b>
&nbsp;
&nbsp;        // listen to month scroll action
<b class="fc">&nbsp;        binding.MonthViewCalendar.monthScrollListener = { month -&gt;</b>
&nbsp;            // Update Month + Year display text on top of month view
<b class="nc">&nbsp;            binding.MonthYearText.text = month.yearMonth.displayText()</b>
&nbsp;
<b class="nc">&nbsp;            selectedDate?.let {</b>
<b class="nc">&nbsp;                selectedDate = null</b>
<b class="nc">&nbsp;                binding.MonthViewCalendar.notifyDateChanged(it)</b>
<b class="nc">&nbsp;            }</b>
<b class="nc">&nbsp;        }</b>
&nbsp;        // Click listener for next month button
<b class="fc">&nbsp;        binding.MonthYearNext.setOnClickListener {</b>
<b class="nc">&nbsp;            binding.MonthViewCalendar.findFirstVisibleMonth()?.let {</b>
<b class="nc">&nbsp;                binding.MonthViewCalendar.smoothScrollToMonth(it.yearMonth.nextMonth)</b>
<b class="nc">&nbsp;            }</b>
<b class="nc">&nbsp;        }</b>
&nbsp;
&nbsp;        // Click Listener for previous month button
<b class="fc">&nbsp;        binding.MonthYearLast.setOnClickListener {</b>
<b class="nc">&nbsp;            binding.MonthViewCalendar.findFirstVisibleMonth()?.let {</b>
<b class="nc">&nbsp;                binding.MonthViewCalendar.smoothScrollToMonth(it.yearMonth.previousMonth)</b>
<b class="nc">&nbsp;            }</b>
<b class="nc">&nbsp;        }</b>
&nbsp;
&nbsp;
<b class="fc">&nbsp;    }</b>
&nbsp;
&nbsp;    private fun configureBinders(daysOfWeek: List&lt;DayOfWeek&gt;) {
<b class="nc">&nbsp;        class DayViewContainer(view: View) : ViewContainer(view) {</b>
<b class="nc">&nbsp;            lateinit var day: CalendarDay</b>
<b class="nc">&nbsp;            val binding = CalendarDayBinding.bind(view)</b>
&nbsp;
<b class="nc">&nbsp;            init {</b>
&nbsp;                // Click listener for each day
<b class="nc">&nbsp;                view.setOnClickListener {</b>
<b class="nc">&nbsp;                    if (day.position == DayPosition.MonthDate) {</b>
<b class="nc">&nbsp;                        if (selectedDate != day.date) {</b>
<b class="nc">&nbsp;                            val oldDate = selectedDate</b>
<b class="nc">&nbsp;                            selectedDate = day.date</b>
&nbsp;
<b class="nc">&nbsp;                            calendarViewModel.setSelectedDate(selectedDate!!)</b>
&nbsp;                            // Change Fragment from month to week on button click
<b class="nc">&nbsp;                            calendarViewModel.changeViewMode(&quot;3-day&quot;)</b>
&nbsp;//                            parentFragmentManager.beginTransaction().apply {
&nbsp;//                                replace(
&nbsp;//                                    R.id.frameLayout_calendarFragment,
&nbsp;//                                    WeekViewFragment(3)
&nbsp;//                                )
&nbsp;//                                addToBackStack(null)
&nbsp;//                                commit()
&nbsp;//                            }
&nbsp;//                            parentFragmentManager.beginTransaction().apply {
&nbsp;//                                replace(
&nbsp;//                                    R.id.frameLayout_calendarFragment,
&nbsp;//                                    DayViewFragment(selectedDate!!)
&nbsp;//                                )
&nbsp;//                                addToBackStack(null)
&nbsp;//                                commit()
&nbsp;//                            }
&nbsp;
&nbsp;
&nbsp;//                            val binding = this@MonthViewFragment.binding
&nbsp;//                            binding.MonthViewCalendar.notifyDateChanged(day.date)
&nbsp;//                            oldDate?.let { binding.MonthViewCalendar.notifyDateChanged(it) }
&nbsp;                        }
&nbsp;                    }
&nbsp;                }
<b class="nc">&nbsp;            }</b>
&nbsp;        }
&nbsp;
<b class="fc">&nbsp;        binding.MonthViewCalendar.dayBinder = object : MonthDayBinder&lt;DayViewContainer&gt; {</b>
<b class="nc">&nbsp;            override fun create(view: View) = DayViewContainer(view)</b>
&nbsp;            override fun bind(container: DayViewContainer, data: CalendarDay) {
<b class="nc">&nbsp;                container.day = data</b>
<b class="nc">&nbsp;                val context = container.binding.root.context</b>
<b class="nc">&nbsp;                val textView = container.binding.calendarDayText</b>
<b class="nc">&nbsp;                val layout = container.binding.calendarDayLayout</b>
&nbsp;                // Set Day of month for each day &quot;cell&quot;
<b class="nc">&nbsp;                textView.text = data.date.dayOfMonth.toString()</b>
&nbsp;
<b class="nc">&nbsp;                val eventTopView = container.binding.EventTop</b>
<b class="nc">&nbsp;                val eventBottomView = container.binding.EventBottom</b>
<b class="nc">&nbsp;                eventTopView.background = null</b>
<b class="nc">&nbsp;                eventBottomView.background = null</b>
&nbsp;
<b class="nc">&nbsp;                if (data.position == DayPosition.MonthDate) {</b>
<b class="nc">&nbsp;                    textView.setTextColor(resources.getColor(R.color.black))</b>
<b class="nc">&nbsp;                    layout.setBackgroundResource(if (selectedDate == data.date) R.drawable.example_5_selected_bg else 0)</b>
&nbsp;
<b class="nc">&nbsp;                    val eventsThisDay = eventsThisMonth?.get(data.date)</b>
&nbsp;//                    Log.i(TAG, eventsThisDay.toString())
<b class="nc">&nbsp;                    if (eventsThisDay != null) {</b>
&nbsp;                        // Indicate number of events today
<b class="nc">&nbsp;                        if (eventsThisDay.count() == 1) {</b>
<b class="nc">&nbsp;                            eventBottomView.setBackgroundColor(Color.parseColor(eventsThisDay[0].color))</b>
&nbsp;                        } else {
<b class="nc">&nbsp;                            eventTopView.setBackgroundColor(Color.parseColor(eventsThisDay[0].color))</b>
<b class="nc">&nbsp;                            eventBottomView.setBackgroundColor(Color.parseColor(eventsThisDay[1].color))</b>
&nbsp;                        }
&nbsp;                    }
&nbsp;                } else {
<b class="nc">&nbsp;                    textView.setTextColor(resources.getColor(R.color.example_5_text_grey))</b>
<b class="nc">&nbsp;                    layout.background = null</b>
&nbsp;                }
<b class="nc">&nbsp;            }</b>
&nbsp;        }
&nbsp;
<b class="nc">&nbsp;        class MonthViewContainer(view: View) : ViewContainer(view) {</b>
<b class="nc">&nbsp;            val monthHeader = CalendarHeaderBinding.bind(view).monthHeader.root</b>
&nbsp;        }
&nbsp;
&nbsp;        // Set font
<b class="fc">&nbsp;        val typeFace = Typeface.create(&quot;sans-serif-light&quot;, Typeface.NORMAL)</b>
<b class="fc">&nbsp;        binding.MonthViewCalendar.monthHeaderBinder =</b>
<b class="fc">&nbsp;            object : MonthHeaderFooterBinder&lt;MonthViewContainer&gt; {</b>
<b class="nc">&nbsp;                override fun create(view: View) = MonthViewContainer(view)</b>
&nbsp;                override fun bind(container: MonthViewContainer, data: CalendarMonth) {
<b class="nc">&nbsp;                    if (container.monthHeader.tag == null) {</b>
<b class="nc">&nbsp;                        container.monthHeader.tag = data.yearMonth</b>
<b class="nc">&nbsp;                        container.monthHeader.children.map { it as TextView }</b>
<b class="nc">&nbsp;                            .forEachIndexed { index, tv -&gt;</b>
<b class="nc">&nbsp;                                tv.text = daysOfWeek[index].displayText(uppercase = true)</b>
<b class="nc">&nbsp;                                tv.setTextColor(resources.getColor(R.color.black))</b>
<b class="nc">&nbsp;                                tv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 12f)</b>
<b class="nc">&nbsp;                                tv.typeface = typeFace</b>
<b class="nc">&nbsp;                            }</b>
&nbsp;                    }
<b class="nc">&nbsp;                }</b>
&nbsp;            }
&nbsp;
&nbsp;
<b class="fc">&nbsp;    }</b>
&nbsp;
<b class="fc">&nbsp;    companion object {</b>
<b class="fc">&nbsp;        private val TAG: String = MonthViewFragment::class.java.name</b>
&nbsp;    }
&nbsp;
&nbsp;}
&nbsp;
&nbsp;
&nbsp;
&nbsp;
&nbsp;
&nbsp;
&nbsp;
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();


</script>

<div class="footer">

    <div style="float:right;">generated on 2024-05-12 21:32</div>
</div>
</body>
</html>
